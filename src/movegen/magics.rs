use crate::defs::{Bitboard, NrOf};

pub const ROOK_MAGIC_NRS: [u64; NrOf::SQUARES] = [
    36029347047407720u64,
    149322478366302336u64,
    321607159529488u64,
    70370891686272u64,
    1734237771133878304u64,
    351844266442754u64,
    9087532868306176u64,
    4611968043163074593u64,
    18015775851913218u64,
    9241527310312538244u64,
    580969025002020872u64,
    4611827928443928576u64,
    9847261460181303296u64,
    4612073054305304576u64,
    22658873135464576u64,
    14006486298676699265u64,
    36038005437239298u64,
    4647855690382061568u64,
    3800462209851392u64,
    288529445464049792u64,
    22799885447204928u64,
    147142144124059672u64,
    9232469673122472448u64,
    2817086506156058u64,
    6953566621021536292u64,
    4666151632587737088u64,
    4611827305805778945u64,
    281513636659297u64,
    9225626035961200896u64,
    8070556154251575360u64,
    1155595585605600384u64,
    283846336577605u64,
    5332270824162591232u64,
    9223512791531464704u64,
    60799694632128548u64,
    14992509552091475200u64,
    1125934274974848u64,
    651896063375999104u64,
    18726074189056u64,
    651051904936183809u64,
    144119657291319297u64,
    792915043820765952u64,
    720999802413794304u64,
    29836356122313768u64,
    12719854764523784400u64,
    9800044052694434064u64,
    1125925685036160u64,
    281578123036163u64,
    72059793077960836u64,
    9232942194653167880u64,
    1188963495798976520u64,
    72620827462603016u64,
    1266658878427648u64,
    576602623931842690u64,
    36352637291520u64,
    4976486392935813140u64,
    72058693553781122u64,
    4611826760211808384u64,
    9300216904810039428u64,
    9025349787320897u64,
    5314247852388515969u64,
    1738390562124464132u64,
    18693912281600u64,
    612916162133565506u64,
];

pub const BISHOP_MAGIC_NRS: [u64; NrOf::SQUARES] = [
    1134764786982976u64,
    1387258356322009152u64,
    1171006290449925120u64,
    4574529133347330u64,
    37194373837885568u64,
    9298824966151622913u64,
    1189233095430177162u64,
    1689683655393860u64,
    2260698998784000u64,
    18023237954966066u64,
    149439161756090624u64,
    13840707346630191136u64,
    1143527795528196u64,
    288802173772375040u64,
    294002816224329856u64,
    17872467267634u64,
    87266043185078273u64,
    2918913105138491400u64,
    13511108661022752u64,
    2630172826946110528u64,
    36169674094548992u64,
    1153033658584551424u64,
    74320390411255808u64,
    4611686018983659520u64,
    2308728681782099968u64,
    4620983524302807040u64,
    438115835643576612u64,
    5769674210725101600u64,
    4402475958528u64,
    4613375143438205440u64,
    11530345346236678144u64,
    5102438467584u64,
    73197925068440705u64,
    18018818102263825u64,
    36591764162888224u64,
    145135593660417u64,
    171700302729576962u64,
    9322468846621169680u64,
    9288829739731520u64,
    9223934987363959052u64,
    144414289665458208u64,
    190569590925034048u64,
    562988612387904u64,
    83603565674793600u64,
    4630835113545040001u64,
    9273650505668624640u64,
    1748667725355958288u64,
    4758618774071940160u64,
    571750409568512u64,
    577030613196873984u64,
    4623299077439244288u64,
    2308095530594867208u64,
    9225624422950045698u64,
    2346555727981609360u64,
    234231195993933832u64,
    2288222277795908u64,
    216403709639802900u64,
    72058169966404640u64,
    9243796852627804160u64,
    32722634307437072u64,
    2254171743201024u64,
    582264472207872u64,
    13585600577970432u64,
    1157717857862214145u64,
];

#[derive(Default, Copy, Clone)]
pub struct Magic {
    pub mask: Bitboard,
    pub shift: u8,
    pub offset: u64,
    pub nr: u64,
}

impl Magic {
    pub fn get_index(&self, occupancy: Bitboard) -> usize {
        let blockerboard = occupancy & self.mask;
        ((blockerboard.wrapping_mul(self.nr) >> self.shift) + self.offset) as usize
    }
}
